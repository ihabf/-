<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ’¬ Ø¯Ø±Ø¯Ø´Ø© Ù…Ø¤Ù‚ØªØ©</title>
<!-- Ù…ÙƒØªØ¨Ø© SHA256 Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„ØªØ´ÙÙŠØ± Ù…Ù† Ø¬Ø§Ù†Ø¨ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø¸Ø± -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-sha256/0.9.0/sha256.min.js"></script>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js";
import { getDatabase, ref, push, set, remove, onValue, onChildAdded, onChildRemoved, onDisconnect, get, update } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-database.js";
import { getFunctions, httpsCallable } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-functions.js";

// ğŸ”¹ Ø¥Ø¹Ø¯Ø§Ø¯ Firebase
const firebaseConfig = {
  apiKey: "AIzaSyDzGM7Zy6JIrFJyDj7s5SjAd-l8rbCe9VE",
  // ... (Ø¨Ø§Ù‚ÙŠ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase)
  authDomain: "kelta-gmae.firebaseapp.com",
  databaseURL: "https://kelta-gmae-default-rtdb.firebaseio.com",
  projectId: "kelta-gmae",
  storageBucket: "kelta-gmae.firebasestorage.app",
  messagingSenderId: "247464874751",
  appId: "1:247464874751:web:779a3120e6b422fdee72ca",
  measurementId: "G-6C8HGRKLHS"
  // ...
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const functions = getFunctions(app);

const usersRef = ref(db, "users");
const messagesRef = ref(db, "messages");
const typingRef = ref(db, "typing");
const gameRef = ref(db, "game_state"); // ğŸ Ø¹Ù‚Ø¯Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
const kickedUsersRef = ref(db, "kickedUsers"); // ğŸš« Ø¹Ù‚Ø¯Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø·Ø±ÙˆØ¯ÙŠÙ†
const bannedIPsRef = ref(db, "bannedIPs"); // ğŸš« Ø¹Ù‚Ø¯Ø© Ù„Ù„Ù€ IPs Ø§Ù„Ù…Ø­Ø¸ÙˆØ±Ø©
const savedUsersRef = ref(db, "savedUsers");

const ADMIN_NAME = "KeltA";

// ğŸ¤– Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨ÙˆØª "Ø¨Ø³Ø§Ù…"
const BOT_NAME = "Ø§Ù„Ø¨ÙˆØª Ø¨Ø³Ø§Ù…âœ”";
const BOT_COLOR = "#f30217"; // âœ¨ Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø°ÙŠ Ø³ÙŠØ¸Ù‡Ø± Ø¨Ù‡ Ø§Ø³Ù… Ø§Ù„Ø¨ÙˆØª (Ø­Ø§Ù„ÙŠØ§Ù‹ Ø£Ø­Ù…Ø±)
const BOT_AVATAR_COLOR = "red"; // Ù„ÙˆÙ† Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø£ÙØ§ØªØ§Ø± ÙÙŠ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªØµÙ„ÙŠÙ†
const BOT_AVATAR_URL = "https://i.pinimg.com/736x/2a/0d/77/2a0d77e1bf6d19ab336921683544bb35.jpg"; // âœ¨ Ø¶Ø¹ Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„Ø¨ÙˆØª Ù‡Ù†Ø§
const BOT_WORDS_LIST = ["Ù‚Ù„Ø¨","Ø±Ù…Ø­","Ø¹Ø´Ø¨","ØµÙ†Ø¯ÙˆÙ‚","Ø­Ø¨Ù„","Ø§Ø´Ø§Ø±Ø©Ù…Ø±ÙˆØ±","Ø«Ø¹Ù„Ø¨","ÙŠØ¶Ø­Ùƒ","Ù‚Ù†ÙØ°","Ø¹Ù„Ù…","Ø¨Ù‚Ø±Ø©","ÙƒÙ„Ø¨","Ø´Ø¨Ø­","Ù‚Ù†Ø¨Ù„Ø©","Ù†Ø¹Ø§Ù…Ø©","Ø³Ø¬Ù‚","Ø¯ÙŠÙƒ","Ù‚Ø·Ø§ÙŠÙ","Ø±ÙˆØ¨ÙˆØª","Ø¹Ø´Ø¨","Ø¨Ø·Ø©","ÙŠÙ…Ø´ÙŠ","Ø§Ø¨Ø±Ø©","Ø°Ø¦Ø¨","Ù†Ø§ÙØ°Ø©","ÙØ±Ø´Ø©","ØµØ­Ù†","Ø¨Ø·Ø±ÙŠÙ‚","Ù…Ù„Ùƒ","Ø³ÙƒØ±","Ø¨Ø±Ø¬Ø§ÙŠÙÙ„","Ù…Ø²Ø±Ø¹Ø©","Ù…Ù„ÙÙˆÙ","Ø±ÙˆØ¨ÙŠØ§Ù†","Ù…ÙƒØ©","Ù…Ù†Ø¯ÙŠ","Ø«Ù„Ø¬","Ø°Ø¨Ø§Ø¨Ø©","Ø·Ø§ÙˆÙ„Ø©","Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠ","Ø¬Ø¯Ø§Ø±","Ø§ÙŠØ³ÙƒØ±ÙŠÙ…","Ø³ÙƒÙŠÙ†","Ù…Ø§Ø¹Ø²","ÙƒØ±Ø©Ø³Ù„Ø©","Ø¨Ø·Ø§Ø·Ø§","Ù…Ù„Ùƒ","Ø§ØµØ¨Ø¹","Ø³Ø±ÙˆØ§Ù„","Ø¨ØµÙ„","Ø³Ù„Ùƒ","Ø³Ø§Ø¦Ù‚","Ø·Ù…Ø§Ø·Ù…","ÙƒÙ†Ø§ÙØ©","Ø§Ø°Ù†","Ø¬ÙˆØ§Ù„","Ù†Ù…Ø±","Ø·Ø§ÙˆÙˆØ³","Ø«ÙˆØ±","Ø®ÙˆØ®","ØªÙˆØµÙŠÙ„Ø©","Ù‚Ù…Ø±","Ø´Ø§Ø±Ø¹","Ù…Ù†Ø³Ù","Ù…Ø§Ù†Ø¬Ùˆ","Ø¯Ù…","Ù…Ø§Ø¡","Ø·ÙŠØ§Ø±","Ø¹ÙˆØ¯","Ø¨Ø§Øµ","Ø¬Ø²ÙŠØ±Ø©","ØªØ§Ø¬","Ø¹ØµØ§","ØªÙ…Ø³Ø§Ø­","Ù‚Ø¯Ù…","Ø¨ÙŠØ¶","Ø­Ø²ÙŠÙ†","ÙØ£Ø³","Ù‡Ø§ØªÙ","Ø­ÙˆØª","Ø±ÙˆØ¨ÙŠØ§Ù†","Ø¸ÙØ±","Ù‚ÙÙ„","Ø³Ø§Ø¹Ø©","Ø¹Ø³Ù„","Ø¬ÙˆØ²Ø§Ù„Ù‡Ù†Ø¯","ÙƒÙ†Ø¨","Ø¹ØµÙÙˆØ±","ÙØ·Ø±","Ù‚Ø·Ù‡","Ù…Ø®Ø¯Ø©","Ø´Ø§ÙˆØ±Ù…Ø§","ØªÙˆØª","Ù…Ø³Ø·Ø±Ø©","ÙØ±Ø§ÙˆÙ„Ø©","Ù‡Ø¯Ù‡Ø¯","Ù‚Ø±Ø¯","Ø²Ù‡Ø±Ø©","Ø°Ø±Ø©","Ù…ÙƒØªØ¨","Ø¯ÙˆÙ„Ø§Ø¨","ÙÙŠØ´","ÙØ´Ø§Ø±","Ø³Ù…Ø§Ø¡","ÙŠØ³Ø¨Ø­","ÙÙŠÙ„","ØªÙ†ÙŠÙ†","Ø´Ø±ÙŠØ·","Ø°Ù‡Ø¨","Ø§Ù„Ø§Ø±Ø¶","Ø¨Ø±ÙˆÙƒÙ„ÙŠ","ØºÙŠÙˆÙ…","Ø´ÙˆÙƒÙˆÙ„Ø§ØªÙ‡","Ø¨Ø±Ø¬Ø±","ÙÙ„ÙˆØ³","ÙˆØ­ÙŠØ¯Ø§Ù„Ù‚Ø±Ù†","ÙØ§Ù†ÙˆØ³","Ø³Ù†Ø¬Ø§Ø¨","Ù…Ù„Ø¹Ù‚Ø©","Ù…Ù„Ø¹Ù‚Ø©","Ø®Ø±ÙŠØ·Ø©","ØµØ±ØµÙˆØ±","Ù…Ù†Ø¯ÙŠÙ„","ÙƒØ§ØªØ´Ø¨","Ù…ØµØ§ØµØ©","Ø¯Ø¨Ù‚Ø·Ø¨ÙŠ","Ù†ÙŠØ²Ùƒ","Ø±Ù…Ø§Ù†","Ø´Ø§Ø±Ø¹","Ø¹Ù‚Ø±Ø¨","Ø­Ù…Ø§Ø±","Ø¹ØµÙÙˆØ±","ØªÙ„ÙØ§Ø²","Ø­ÙØ±Ø©","Ù†Ø§Ø±","Ø­Ù‚ÙŠØ¨Ø©","Ø·Ø§ÙˆÙ„Ù‡","ÙƒØ±Ø©Ù‚Ø¯Ù…","Ø¯Ø±Ø¹","Ø¯Ø¨","Ø¨Ù‚Ù„Ø§ÙˆØ©","Ø§Ù†Ø§Ù†Ø§Ø³","Ø³Ø±ÙŠØ±","Ø²ÙŠØªÙˆÙ†","ØºÙˆØ±ÙŠÙ„Ø§","Ø³Ù„Ù…","Ø´Ø§Ø­Ù†Ø©","Ù…Ø³Ø¬Ø¯","Ø¹ØµØ§","Ø¨Ø±ÙƒØ§Ù†","Ù‚Ø¯Ù…","Ù‚ÙˆØ³","Ø´Ø·Ø±Ù†Ø¬","ØªØ§Ø¬","Ø¹Ø§Ù…Ù„Ù†Ø¸Ø§ÙØ©","ØºØ³Ø§Ù„Ø©","Ù…Ù†Ø´Ø§Ø±","Ø­ÙˆØª","Ù…Ø³Ø¯Ø³","Ø¨Ø§Ø¨","Ø¯Ù…ÙŠØ©","Ø¬Ø§Ù…ÙˆØ³","Ø¹Ø§Ø¦Ù„Ø©","Ù„ÙŠÙ„","Ø­Ø°Ø§Ø¡","Ø²Ø±Ø§ÙØ©","Ø·Ø§Ø¨Ø¹Ø©","Ù†Ù…Ù„","Ø¯ÙˆÙ„Ø§Ø¨","Ø®ÙŠØ§Ø±","Ø´ÙˆØ±Ø¨Ø©","Ø³ØªØ§Ø±Ø©","ÙƒÙŠØ³","Ø±ÙŠÙ…ÙˆØª","Ø¯Ø¨Ø§Ø³Ø©","Ø³Ù„Ø·Ø¹ÙˆÙ†","Ø¨Ø§Ø°Ù†Ø¬Ø§Ù†","Ù…Ø²Ù‡Ø±ÙŠØ©","Ù…Ø®Ø¯Ø©","Ø³ÙŠÙ","Ù…ÙƒØªØ¨Ø©","ÙˆØ±Ù‚Ø©","Ù…ÙƒØªØ¨","ÙØ³ØªØ§Ù†","Ù…Ø´Ù…Ø´","ÙƒÙˆØ¨","ÙƒØ´Ø±ÙŠ","Ø³Ù„Ø­ÙØ§Ø©","Ø­Ù„ÙŠØ¨","Ù…Ø¬Ø±Ø©","Ù†Ø³Ø±","ØºÙˆØ§ØµØ©","Ø®Ø´Ø¨","Ù†Ø¸Ø§Ø±Ø©","Ø§ÙÙˆÙƒØ§Ø¯Ùˆ","Ù‚Ø§Ø±Ø¨","Ø¨ÙŠØ§Ù†Ùˆ","Ø°Ø±Ø©","Ù…Ø³Ø±Ø­","Ø´Ù†Ø¨","Ø§Ø³Ù†Ø§Ù†","Ø§Ù†Ù","Ù…Ø±ÙˆØ­Ø©","Ù‚Ù‡ÙˆØ©","ÙÙ‚Ù…Ø©","Ø³Ø±ÙŠØ±","Ø­Ø¯ÙŠÙ‚Ø©","Ø¨Ù„ÙŠØ§Ø±Ø¯Ùˆ","Ø³Ø§Ø¹Ø©Ø±Ù…Ù„ÙŠØ©","Ù†Ù‡Ø±","Ù‚Ù†ÙØ°","ÙÙˆÙ„","ÙÙ„Ø§Ø´Ø©","Ù…ØµØ¨Ø§Ø­","Ù„Ø³Ø§Ù†","Ø³ÙŠØ§Ø±Ø©","Ù‚Ù„Ù…Ø±ØµØ§Øµ","Ø³Ù…ÙƒØ©","ÙƒÙˆÙƒÙŠØ²","Ø·Ø§Ø¦Ø±Ø©","Ø¶ÙØ¯Ø¹","ÙƒØ§Ù…ÙŠØ±Ø§","ØªÙ…Ø±","Ø®Ø´Ø¨","Ø´Ø±Ø§Ø¨","Ø¹ÙŠÙ†","ÙƒÙˆØ§Ù„Ø§","Ø²Ø±","Ø¨Ø§Ù…ÙŠØ©","Ø¶Ø¨Ø¹","ÙŠØ¨ÙƒÙŠ","ØºØ±Ø§Ø¨","Ø®Ø¨Ø²","Ù…Ø³Ù…Ø§Ø±","Ù…ÙˆÙŠØ©","Ù†Ø®Ù„Ø©","ÙƒØ±Ø²","Ø¨ÙŠØªØ²Ø§","Ø´ÙˆÙƒØ©","Ø¯ÙƒØªÙˆØ±","Ù…Ø±Ø¢Ø©","Ù…Ø§ÙŠÙƒ","Ø·Ø±ÙŠÙ‚","Ù…ØºÙ†ÙŠ","ØºØ§Ø¨Ø©","Ø¬Ø¨Ù„","Ù‡ÙŠÙƒÙ„Ø¹Ø¸Ù…ÙŠ","Ø¨Ø­Ø±","Ù…Ø¸Ù„Ø©","ÙƒØ¨Ø©","Ù„Ø§Ø¹Ø¨","Ø®Ø³","Ø³Ø§Ø¹Ø©","Ø¨Ø±Ø¬Ø®Ù„ÙŠÙØ©","Ø¬Ø²Ø±","ÙˆØ³Ø§Ø¯Ø©","Ø®ÙŠÙ…Ø©","Ø®ÙŠØ§Ø·","Ø³Ø¨Ø§Ù†Ø®","Ø±Ù‚Øµ","Ø¯Ø¬Ø§Ø¬","ØµÙŠØ¯Ù„ÙŠ","Ø§Ø·ÙØ§Ø¦ÙŠ","ÙƒØ¨Ø³Ø©","ÙƒÙŠØ¨ÙˆØ±Ø¯","Ø·Ø§ÙˆÙ„Ø©","Ø³Ø¬Ø§Ø¯Ù‡","Ù…Ø­ÙØ¸Ø©","Ø®Ù†Ø²ÙŠØ±","ÙƒØ±Ø©","Ø¹Ù†Ø¨","Ø´Ø§Ø´Ø©","Ù‚Ø§Ø¶ÙŠ","Ø°Ø¦Ø¨","Ø´Ø¬Ø±Ø©","Ø´Ø§ÙŠ","Ù†Ø¹Ø§Ù„","Ù†Ø¬ÙˆÙ…","ÙØ±Ø§Ø®","ÙÙ„ÙÙ„","Ù†Ø­Ù„Ø©","Ø´Ø§Ù…Ø¨Ùˆ","Ø®ÙØ§Ø´","ÙƒÙ†Ø²","Ù‚ÙˆØ³Ù‚Ø²Ø­","Ø§ØµØ¨Ø¹","Ø§Ø®Ø·Ø¨ÙˆØ·","Ù…Ø­Ø§Ø³Ø¨","ÙƒØªØ§Ø¨","Ø·Ø¨Ø§Ø®","Ø¨Ø±Ù‚","ØºØ²Ø§Ù„","Ø®Ø§ØªÙ…","Ø¹Ø¸Ù…","ÙØ·ÙŠØ±Ø©","Ø¯ÙØªØ±","Ø¨Ø¨ØºØ§Ø¡","Ø¬Ù…Ù„","Ø·Ø±ÙŠÙ‚","Ø¨Ø±ØªÙ‚Ø§Ù„","Ø­Ù…Ø§Ø±ÙˆØ­Ø´ÙŠ","Ø²Ø¨Ø§Ù„Ø©","Ø§Ù„Ù…Ø§Ø³","ÙƒØ±Ø©","ØºØ±ÙØ©","Ø³ØªÙŠÙƒ","Ø­Ù„Ø§ÙˆØ©","Ù†Ù‚Ø§Ù†Ù‚","Ø¯ÙˆØ¯Ø©","Ù…Ù„Ø¹Ø¨","ÙƒØ±Ø©Ø³Ù„Ø©","Ù…Ù…Ø«Ù„","Ø²ÙŠØª","ÙƒÙ†Ø¨Ø©","ÙƒØªØ§Ø¨","Ù…Ø¯Ø±Ø³Ø©","Ø§Ù„Ù…Ø§Ø³","Ø§Ù„ÙƒØ¹Ø¨Ø©","ÙŠØ¶Ø­Ùƒ","Ù…ÙƒÙŠØ§Ø¬","Ø¨Ø³ÙƒÙˆØª","Ø³Ù…Ø¨ÙˆØ³Ø©","Ø´Ø§Ø­Ù†","Ø¬Ø¨Ù†","Ø´Ù…Ø§Ù…","Ù…Ø°ÙŠØ¹","ØµØ­Ø±Ø§Ø¡","ÙØ±Ø´Ø§Ø©","Ø­Ù…Ø§Ù…","Ø¨ÙˆÙ…Ø©","Ø³ÙŠÙ","Ù„ÙŠÙ„","Ù…ÙˆØ²","ØµØ¨Ø§Ø±","ÙˆØ­Ø´","Ø¬Ø§ÙƒÙŠØª","Ø¬ÙˆØ§ÙØ©","Ø¨Ø·Ø§Ø±ÙŠØ©","Ø´Ù…Ø¹Ø©","Ù„ÙŠÙ…ÙˆÙ†","Ø¬ÙˆÙ‡Ø±Ø©","Ù…Ø¹Ø¯Ø©","Ø´Ø§Ø·Ø¦","Ø¨Ø§Ù†Ø¯Ø§","Ø¯ÙˆÙ†Ø§Øª","ÙØ±Ø§Ø´Ø©","Ø§Ø±Ù†Ø¨","Ø§Ø³Ø¯","Ø³ÙÙŠÙ†Ø©","Ø¹ØµÙŠØ±","Ù†Ø¬ÙˆÙ…","ÙˆÙ„Ø§Ø¹Ø©","Ù…ÙƒØ±ÙˆÙ†Ø©","Ø«ÙˆØ¨","Ø³ÙƒÙŠÙ†","Ù‚Ø¯Ø±","ØªØ¨ÙˆÙ„Ø©","Ø¨Ø·ÙŠØ®","ÙˆØ³Ø§Ø¯Ø©","Ø§Ø¨Ø±Ø©","Ø³ÙˆØ´ÙŠ","ØµØ§Ø±ÙˆØ®","Ø¬Ø§Ù„Ø³","Ø³Ù…Ø§Ø¹Ø©","Ø´Ø±Ø·ÙŠ","Ù…ÙƒÙŠÙ","Ù‚Ø·Ø©","Ù…Ù‚Ù„ÙˆØ¨Ø©","Ù…Ù‚Øµ","Ø¯Ø¬Ø§Ø¬Ù…Ø´ÙˆÙŠ","ÙØ£Ø³","ÙØ±Ø³Ø§Ù„Ù†Ù‡Ø±","Ø·Ø¨Ù„","ÙŠØ±ÙƒØ¶","Ù…ÙƒÙ†Ø³Ø©","Ù‚Ù„Ù…Ø±ØµØ§Øµ","Ø­Ø§Ø¬Ø¨","Ø§Ø¹ØµØ§Ø±","ÙƒÙˆØ®","Ø´ÙˆÙƒØ©","Ù…Ø·Ø±","ÙÙ‡Ø¯","Ù‚Ø¨Ø¹Ø©","Ø«Ø¹Ø¨Ø§Ù†","Ø±Ø³Ø§Ù…","ØºÙŠÙˆÙ…","Ø­Ù…Øµ","ÙŠØ¯","Ø¹Ù†ÙƒØ¨ÙˆØª","Ø¨Ø±ÙŠØ§Ù†ÙŠ","Ø³Ø­Ù„ÙŠØ©","Ù„Ø­Ù…","ÙˆØ±Ø¯Ø©","Ù…Ø·Ø¹Ù…","Ø¬Ø±Ø³","Ø³Ø¨ÙˆØ±Ø©","Ø¨Ø·Ù†","Ù‚Ø§Ø±ÙˆØ±Ø©","Ø³ÙŠÙ†Ù…Ø§","Ù…Ù‡Ù†Ø¯Ø³","Ø¹Ø·Ø±","ÙˆØ±Ù‚Ø¹Ù†Ø¨","Ù…Ø¹Ù„Ù…","Ù…Ù…Ø±Ø¶Ø©","Ø³Ù„Ù…","Ù…Ø·Ø±","Ø¹ØµØ§","ÙƒØ±ÙŠØ¨","Ø¨Ø±Ù‚","Ù‚Ø·Ø§Ø±","ÙƒØ¨Ø§Ø¨","Ø·ÙÙ„","Ø´Ù„Ø§Ù„","ÙŠØ¨ÙƒÙŠ","Ø³Ù„Ø·Ø©","Ø³Ø¬Ø§Ø¯Ø©","Ù…Ø´Ø·","Ù‚Ø¨Ø¹Ø©","Ø®Ù„Ø§Ø·","Ù†ÙˆÙ…","Ø´ØªØ§Ø¡","Ø­Ø²ÙŠÙ†","Ù„ÙŠÙ„","Ø«Ù„Ø§Ø¬Ø©","ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ","ÙƒØ£Ø³","Ø´Ø§ÙŠ","Ø¬Ø§Ù…Ø¹Ø©","Ø¨Ø±Ø¬","ØªÙØ§Ø­","Ø¹Ø´Ø¨","Ø¨Ø·Ù‡","Ø¬Ù…Ø¬Ù…Ø©","ÙƒØ±Ø³ÙŠ","Ø¨Ø·Ø§Ø·Ø³","Ø¨Ø³ÙƒÙˆØª","Ù…ÙƒÙ†Ø³Ø©","ÙƒÙŠÙƒ","Ø§ÙÙˆÙƒØ§Ø¯Ùˆ","ØµØ§Ø¨ÙˆÙ†","Ù‚Ù…Ø±","Ù‡Ø±Ù…","Ø³Ø§Ø¹Ø©ÙŠØ¯","ÙƒÙˆÙƒØ¨","Ù„Ø§Ø¨ØªÙˆØ¨","Ø´Ù†Ø·Ø©","Ø¹Ù…Ø§Ø±Ø©","Ø¨ÙŠØª","Ø¯ÙŠÙ†Ø§ØµÙˆØ±","ÙØ±Ù†","Ø±Ø²","Ù…ÙØªØ§Ø­","Ø±Ù…ÙˆØ´","Ø¬ÙˆØ§Ø±Ø¨","Ù…Ø¯ÙŠÙ†Ø©","Ù‚Ù„Ù…","Ø³Ù„Ø©","Ø­ØµØ§Ù†","Ø²ÙˆÙ…Ø¨ÙŠ","Ù†Ø¬Ù…Ø©","Ø¹Ù„Ø¨Ø©","Ù…Ø·Ø¨Ø®","ÙØ§ØµÙˆÙ„ÙŠØ§","Ù‚Ù‡ÙˆØ©","ÙƒÙ…Ø¨ÙŠÙˆØªØ±","Ù…Ù„ÙˆØ®ÙŠØ©","Ù‚Ù…ÙŠØµ","Ù…Ø±Ø­Ø§Ø¶","ÙÙ…","ØµÙ‚Ø±","Ø·Ø§ÙˆÙ„Ù‡"]; // Ù‚Ø§Ø¦Ù…Ø© ÙƒÙ„Ù…Ø§Øª Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„
let savedBotWords = JSON.parse(localStorage.getItem("savedBotWords")) || [];

// ğŸ Ø­Ø§Ù„Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ© (ØªØªÙ… Ù…Ø²Ø§Ù…Ù†ØªÙ‡Ø§ Ù…Ø¹ Firebase)
let localGameState = {
    inProgress: false,         // Ù‡Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¬Ø§Ø±ÙŠØ©ØŸ
    countdownActive: false,    // Ù‡Ù„ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ Ù†Ø´Ø·ØŸ
    countdownInitiatorId: null,// Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø°ÙŠ Ø¨Ø¯Ø£ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
    gameWords: [],             // Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù„Ù„Ø¹Ø¨Ø©
    gameStartTime: 0,          // ÙˆÙ‚Øª Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„ÙØ¹Ù„ÙŠ (Ø¨Ø¹Ø¯ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ)
    lastGameId: null           // Ù…Ø¹Ø±Ù ÙØ±ÙŠØ¯ Ù„ÙƒÙ„ Ø¬ÙˆÙ„Ø© Ù„Ø¹Ø¨Ø© Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø±
};

// ğŸš© Ù…ØªØºÙŠØ± Ù…Ø­Ù„ÙŠ Ù„ØªØªØ¨Ø¹ Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù‚Ø¯ Ø¨Ø¯Ø£ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ Ù„Ø¬ÙˆÙ„Ø© Ù…Ø¹ÙŠÙ†Ø©
// Ù‡Ø°Ø§ ÙŠØ¶Ù…Ù† Ø£Ù† Ø¹Ù…ÙŠÙ„Ù‹Ø§ ÙˆØ§Ø­Ø¯Ù‹Ø§ ÙÙ‚Ø· ÙŠÙ‚ÙˆÙ… Ø¨ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø¥Ù„Ù‰ Firebase
let initiatedCountdownGameId = null;

// ğŸ”¹ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¹Ø±Ù ÙØ±ÙŠØ¯ Ù„Ù„Ø¬Ù‡Ø§Ø²
let deviceId = localStorage.getItem("chat_device_id") || "dev_" + Math.floor(Math.random()*1e9);
localStorage.setItem("chat_device_id", deviceId);

// ğŸ”¹ Ø§Ø®ØªÙŠØ§Ø± Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
async function chooseUsername() {
  let username = localStorage.getItem("chat_username");
  const savedData = (await get(savedUsersRef)).val() || {};
  if(username && savedData[username]?.deviceId===deviceId) return username;

  let valid=false;
  while(!valid){
    username = prompt("Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ:")?.trim();
    if(!username) continue;
    const usersData = (await get(usersRef)).val() || {};
    const nameTaken = Object.values(usersData).some(u=>u.name===username);
    const nameSavedElsewhere = savedData[username] && savedData[username].deviceId!==deviceId;
    if(nameTaken || nameSavedElsewhere) continue;
    valid=true;
  }
  localStorage.setItem("chat_username", username);
  return username;
}

const username = await chooseUsername();

// ğŸš« Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø¸Ø± Ù‚Ø¨Ù„ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø§ØªØµØ§Ù„
async function checkBanStatus() {
    // Ù‡Ø°Ù‡ Ø¯Ø§Ù„Ø© ÙˆÙ‡Ù…ÙŠØ© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ IPØŒ ÙÙŠ Cloud Function Ø³ÙŠÙƒÙˆÙ† Ø­Ù‚ÙŠÙ‚ÙŠÙ‹Ø§
    // Ù„Ø£ØºØ±Ø§Ø¶ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±ØŒ Ø³Ù†Ø³ØªØ®Ø¯Ù… Ù‚ÙŠÙ…Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© Ø£Ùˆ Ø«Ø§Ø¨ØªØ©
    const userIP = "192.168.1." + (Math.floor(Math.random() * 254) + 1); // IP ÙˆÙ‡Ù…ÙŠ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±
    const ipHash = sha256(userIP); // Ø§Ø³ØªØ®Ø¯Ø§Ù… sha256 Ù…Ù† Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ©

    const bannedSnapshot = await get(ref(db, `bannedIPs/${ipHash}`));
    if (bannedSnapshot.exists()) {
        document.body.innerHTML = `<div class="ban-message"><h1>ğŸš« Ø£Ù†Øª Ù…Ø­Ø¸ÙˆØ±</h1><p>ØªÙ… Ø­Ø¸Ø±Ùƒ Ù…Ù† Ø¯Ø®ÙˆÙ„ Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©.</p></div>`;
        // Ø¥ÙŠÙ‚Ø§Ù Ø£ÙŠ Ø¹Ù…Ù„ÙŠØ§Øª Ø£Ø®Ø±Ù‰
        throw new Error("User is banned");
    }
}

// ğŸ”¹ Ø¯Ø§Ù„Ø© Ø±Ø¦ÙŠØ³ÙŠØ© Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
async function main() {
    // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø¸Ø±
    try {
        await checkBanStatus();
    } catch (error) {
        console.error(error.message);
        return; // Ø¥ÙŠÙ‚Ø§Ù ØªØ­Ù…ÙŠÙ„ Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø­Ø¸ÙˆØ±Ù‹Ø§
    }

    // ğŸ”¹ ØªØ¹Ø±ÙŠÙ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø­Ø§Ù„Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙˆØ§Ù„ÙƒØªØ§Ø¨Ø©
    let currentUsers = {};
    let currentTyping = {};

    // ğŸ”¹ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù„ÙˆÙ† ÙˆØ­ÙØ¸Ù‡
    const colors = ["#ffadad","#ffd6a5","#fdffb6","#caffbf","#9bf6ff","#a0c4ff","#bdb2ff","#ffc6ff"];
    const userColor = colors[Math.floor(Math.random()*colors.length)];
    await set(ref(db, "savedUsers/"+username), {color:userColor, deviceId});

    // ğŸ”¹ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    const userId = "user_"+Math.floor(Math.random()*1e9); // Ù…Ø¹Ø±Ù ÙØ±ÙŠØ¯ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ
    const userRef = ref(db, "users/"+userId);
    function isMobileDevice() {
        return /Mobi|Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    }
    const deviceType = isMobileDevice() ? 'mobile' : 'desktop';
    // Ø³Ù†Ø¶ÙŠÙ IP ÙˆÙ‡Ù…ÙŠ Ù‡Ù†Ø§ Ù„ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ø¨ÙˆØ§Ø³Ø·Ø© Cloud Function
    // ÙÙŠ Ø§Ù„Ø¨ÙŠØ¦Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©ØŒ Cloud Function Ø³ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù€ IP Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ù…Ù† Ø§Ù„Ø·Ù„Ø¨
    const fakeIP = "192.168.1." + (Math.floor(Math.random() * 254) + 1);
    await set(userRef, { name: username, color: userColor, online: true, lastSeen: Date.now(), device: deviceType, ip: fakeIP });

    // ğŸš« Ù…Ø±Ø§Ù‚Ø¨Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ø±Ø¯
    onValue(ref(db, `kickedUsers/${userId}`), (snapshot) => {
        if (snapshot.exists() && snapshot.val() === true) {
            document.body.innerHTML = `<div class="ban-message"><h1>ğŸš« ØªÙ… Ø·Ø±Ø¯Ùƒ</h1><p>Ù„Ù‚Ø¯ ØªÙ… Ø·Ø±Ø¯Ùƒ Ù…Ù† Ø§Ù„ØºØ±ÙØ© Ø¨ÙˆØ§Ø³Ø·Ø© Ù…Ø´Ø±Ù.</p></div>`;
            onDisconnect(userRef).cancel(); // Ø¥Ù„ØºØ§Ø¡ onDisconnect Ù„Ù…Ù†Ø¹ Ø§Ù„Ø­Ø°Ù
        }
    });
    onDisconnect(userRef).remove();
    setInterval(()=>update(userRef,{online:true,lastSeen:Date.now()}),5000);

    // Ø¹Ù†Ø§ØµØ± Ø§Ù„ØµÙØ­Ø©
    const chatBox=document.getElementById("chat");
    const form=document.getElementById("chatForm");
    const msgInput=document.getElementById("msg");
    const typingBox=document.getElementById("typing");
    const userList=document.getElementById("users");

    // ğŸ”¹ ØµÙˆØª Ù†Ù‚Ø±Ø© Ù‡Ø§Ø¯Ø¦Ø© (Ù…ÙˆÙ„Ø¯ ØµÙˆØªÙŠ ØµØºÙŠØ± Ø¹Ø¨Ø± Web Audio)
    let audioEnabled = false;
    const AudioCtx = window.AudioContext || window.webkitAudioContext;
    const audioCtx = new (AudioCtx)();
    document.addEventListener('click', ()=>{
      audioEnabled = true;
      if(audioCtx.state === 'suspended') audioCtx.resume();
    }, {once: true});

    // Ù…ÙˆÙ„Ø¯ Ù†Ù‚Ø±Ø© Ù‚ØµÙŠØ±Ø© Ù‡Ø§Ø¯Ø¦Ø© (Ø¶ÙˆØ¶Ø§Ø¡ Ù…Ø´Ø·ÙˆÙØ©)
    function playClickNoise({volume = 0.05, duration = 0.018} = {}){
      if(!audioEnabled) return;
      try{
        const sampleCount = Math.max(64, Math.floor(audioCtx.sampleRate * duration));
        const buffer = audioCtx.createBuffer(1, sampleCount, audioCtx.sampleRate);
        const data = buffer.getChannelData(0);
        for(let i=0;i<sampleCount;i++){
          const env = Math.exp(-6 * (i / sampleCount));
          data[i] = (Math.random() * 2 - 1) * env * 0.7;
        }
        const src = audioCtx.createBufferSource();
        src.buffer = buffer;
        const g = audioCtx.createGain();
        g.gain.value = volume;
        src.connect(g);
        g.connect(audioCtx.destination);
        src.start();
        src.stop(audioCtx.currentTime + duration + 0.01);
      }catch(e){ /* silent failure */ }
    }

    // Ù…ÙˆÙ„Ø¯ Ù†ØºÙ…Ø© Ù‚ØµÙŠØ±Ø© (Ù„ØªÙ…ÙŠÙŠØ² Ø§Ù„Ø®Ø±ÙˆØ¬)
    function playBeep({freq = 700, volume = 0.04, duration = 0.06} = {}){
      if(!audioEnabled) return;
      try{
        const osc = audioCtx.createOscillator();
        const g = audioCtx.createGain();
        osc.type = 'sine';
        osc.frequency.value = freq;
        g.gain.value = volume;
        // Ù„ÙÙ‘ Ø³Ø±ÙŠØ¹ Ù„Ù„Ù€ gain Ù„Ø¥ØªÙ‚Ø§Ù† Ø§Ù„Ù†ØºÙ…Ø©
        g.gain.setValueAtTime(0.0001, audioCtx.currentTime);
        g.gain.exponentialRampToValueAtTime(volume, audioCtx.currentTime + 0.01);
        g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + duration);
        osc.connect(g);
        g.connect(audioCtx.destination);
        osc.start();
        osc.stop(audioCtx.currentTime + duration + 0.01);
      }catch(e){ /* silent failure */ }
    }

    // Ø¯ÙˆØ§Ù„ Ù…Ø±ÙŠØ­Ø© Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…/Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø©
    const playJoin = ()=> playClickNoise({volume:1, duration:0.018});
    const playLeave = ()=> playBeep({freq:560, volume:1, duration:0.06});

    // ğŸ”¹ Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù…Ø¹ Ø­Ø§Ù„Ø© Ø§Ù„ÙƒØªØ§Ø¨Ø©
    function renderUsers(users, typingUsers){
      userList.innerHTML = "";
      const isAdmin = username === ADMIN_NAME;

      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨ÙˆØª "Ø¨Ø³Ø§Ù…" Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªØµÙ„ÙŠÙ† Ø¨Ø´ÙƒÙ„ Ø¯Ø§Ø¦Ù…
      const botLi = document.createElement("li");
      botLi.innerHTML = `<img src="${BOT_AVATAR_URL}" class="user-list-avatar"> ${BOT_NAME}`;
      botLi.style.borderRight = `6px solid ${BOT_AVATAR_COLOR}`;
      botLi.style.fontWeight = "bold";
      userList.appendChild(botLi);


      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠÙŠÙ†
      Object.entries(users).forEach(([id,u])=>{
        const li = document.createElement("li");
        let typingAnim = "";
        if(typingUsers[id]){
          typingAnim = `<span class="dots">â€¦</span>`;
        }
        const deviceEmoji = u.device === 'mobile' ? 'ğŸ“±' : 'ğŸ’»';
        
        let adminControls = '';
        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ Ù…Ø´Ø±ÙÙ‹Ø§ ÙˆØ§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶ Ù„ÙŠØ³ Ù‡Ùˆ Ø§Ù„Ù…Ø´Ø±Ù Ù†ÙØ³Ù‡
        if (isAdmin && u.name !== ADMIN_NAME) {
            adminControls = `
                <div class="admin-controls">
                    <button class="kick-btn" data-userid="${id}" data-username="${u.name}">Ø·Ø±Ø¯</button>
                    <button class="ban-btn" data-userid="${id}" data-username="${u.name}" data-ip="${u.ip || 'N/A'}">Ø­Ø¸Ø± IP</button>
                </div>
            `;
        }

        li.innerHTML = `
            <span>${deviceEmoji} ${u.name} ${typingAnim}</span>
            ${adminControls}
        `;
        li.style.borderRight = `6px solid ${u.color}`;
        userList.appendChild(li);
      });
    }

    // ğŸš« Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ ÙˆØ¸Ø§Ø¦Ù Cloud Functions
    const kickUserFn = httpsCallable(functions, 'kickUser');
    const banUserFn = httpsCallable(functions, 'banUser');
    const unbanIpFn = httpsCallable(functions, 'unbanIp');

    // ğŸš« Ù…Ø¹Ø§Ù„Ø¬Ø© Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ…
    userList.addEventListener('click', async (e) => {
        if (e.target.classList.contains('kick-btn')) {
            const targetUserId = e.target.dataset.userid;
            const targetUsername = e.target.dataset.username;
            if (confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø·Ø±Ø¯ ${targetUsername}ØŸ`)) {
                try {
                    // Ø¥Ø¶Ø§ÙØ© callerUsername Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ÙÙŠ Ø§Ù„Ø®Ø§Ø¯Ù…
                    const result = await kickUserFn({ targetUserId, targetUsername, callerUsername: username });
                    console.log(result.data.message);
                } catch (error) {
                    console.error("Error kicking user:", error);
                    alert(`ÙØ´Ù„ Ø§Ù„Ø·Ø±Ø¯: ${error.message}`);
                }
            }
        }

        if (e.target.classList.contains('ban-btn')) {
            const targetUserId = e.target.dataset.userid;
            const targetUsername = e.target.dataset.username;
            const targetIp = e.target.dataset.ip;
            if (confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø­Ø¸Ø± IP Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ${targetUsername} (${targetIp}) ÙˆØ·Ø±Ø¯Ù‡ØŸ`)) {
                try {
                    // Ø¥Ø¶Ø§ÙØ© callerUsername Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ÙÙŠ Ø§Ù„Ø®Ø§Ø¯Ù…
                    const result = await banUserFn({ targetUserId, targetUsername, callerUsername: username });
                    console.log(result.data.message);
                } catch (error) {
                    console.error("Error banning user:", error);
                    alert(`ÙØ´Ù„ Ø§Ù„Ø­Ø¸Ø±: ${error.message}`);
                }
            }
        }
    });

    // ğŸš« Ø¹Ø±Ø¶ ÙˆØ¥Ø¯Ø§Ø±Ø© Ù„ÙˆØ­Ø© Ø§Ù„Ø­Ø¸Ø± Ù„Ù„Ù…Ø´Ø±Ù
    if (username === ADMIN_NAME) {
        const banManagementDiv = document.getElementById('ban-management');
        const bannedIpsList = document.getElementById('banned-ips-list');
        banManagementDiv.classList.add('visible');

        onValue(bannedIPsRef, (snapshot) => {
            bannedIpsList.innerHTML = '';
            const banned = snapshot.val() || {};
            if (Object.keys(banned).length === 0) {
                bannedIpsList.innerHTML = '<li>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù†Ø§ÙˆÙŠÙ† IP Ù…Ø­Ø¸ÙˆØ±Ø© Ø­Ø§Ù„ÙŠÙ‹Ø§.</li>';
            }
            for (const [ipHash, data] of Object.entries(banned)) {
                const li = document.createElement('li');
                li.innerHTML = `
                    <span>
                        ${data.originalIpSnippet || 'N/A'} (Ù…Ø­Ø¸ÙˆØ± Ø¨ÙˆØ§Ø³Ø·Ø©: ${data.bannedBy} ÙÙŠ ${new Date(data.timestamp).toLocaleString()})
                    </span>
                    <button class="unban-btn" data-iphash="${ipHash}">Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­Ø¸Ø±</button>
                `;
                bannedIpsList.appendChild(li);
            }
        });

        bannedIpsList.addEventListener('click', async (e) => {
            if (e.target.classList.contains('unban-btn')) {
                const ipHash = e.target.dataset.iphash;
                if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ù„ØºØ§Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ø­Ø¸Ø±ØŸ')) {
                    try {
                        // Ø¥Ø¶Ø§ÙØ© callerUsername Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ÙÙŠ Ø§Ù„Ø®Ø§Ø¯Ù…
                        const result = await unbanIpFn({ ipHash, callerUsername: username });
                        console.log(result.data.message);
                    } catch (error) {
                        console.error("Error unbanning IP:", error);
                        alert(`ÙØ´Ù„ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­Ø¸Ø±: ${error.message}`);
                    }
                }
            }
        });
    }

    // ğŸ”¹ Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
    onValue(usersRef, snapshot=>{
      currentUsers = snapshot.val() || {};
      renderUsers(currentUsers, currentTyping);
    });

    // ğŸ”¹ Ø¥Ø´Ø¹Ø§Ø± Ø¹Ù†Ø¯ Ø¯Ø®ÙˆÙ„ ÙˆØ®Ø±ÙˆØ¬ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
    onChildAdded(usersRef, snapshot=>{
      const u = snapshot.val();
      if(u.name !== username){
        const div = document.createElement("div");
        div.className="message";
        div.style.fontStyle="italic";
        div.style.color="#55ff55";
        div.textContent = `âœ… ${u.name} Ø§Ù†Ø¶Ù… Ø¥Ù„Ù‰ Ø§Ù„ØºØ±ÙØ©`;
        chatBox.appendChild(div);
        chatBox.scrollTop = chatBox.scrollHeight;
        if(audioEnabled) playJoin();
      }
    });
    onChildRemoved(usersRef, snapshot=>{
      const u = snapshot.val();
      const div = document.createElement("div");
      div.className="message";
      div.style.fontStyle="italic";
      div.style.color="#ff5555";
      div.textContent = `âŒ ${u.name} ØºØ§Ø¯Ø± Ø§Ù„ØºØ±ÙØ©`;
      chatBox.appendChild(div);
      chatBox.scrollTop = chatBox.scrollHeight;
      if(audioEnabled) playBeep({freq:1200, volume:0.5, duration:0.04}); // ØµÙˆØª Ø§Ø³ØªÙ„Ø§Ù… Ø±Ø³Ø§Ù„Ø©
      if(audioEnabled) playLeave();
    });

// ğŸ¤– Ø¯Ø§Ù„Ø© Ù„Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ù…Ù† Ø§Ù„Ø¨ÙˆØª
function sendBotMessage(text) {
  push(messagesRef, {
    user: BOT_NAME,
    color: BOT_COLOR,
    userId: "bot_id", // Ù…Ø¹Ø±Ù Ø®Ø§Øµ Ø¨Ø§Ù„Ø¨ÙˆØª
    text: text,
    time: new Date().toLocaleTimeString(), // Ù„Ù„Ø¹Ø±Ø¶
    timestamp: Date.now() // Ù„Ù„Ø·ÙˆØ§Ø¨Ø¹ Ø§Ù„Ø²Ù…Ù†ÙŠØ© Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø© (Ù„Ø¹Ø¨Ø© Ø§Ù„Ø³Ø±Ø¹Ø©)
  });
}

// ğŸ”¹ Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ÙÙ‚Ø· Ø¨Ø¹Ø¯ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
let firstLoad = true;
onChildAdded(messagesRef, snapshot=>{
  // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„ÙŠ Ù„Ù„ØµÙØ­Ø©ØŒ Ù„Ø§ ØªØ¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©.
  if (firstLoad) return;

  const m = snapshot.val();
  const messageKey = snapshot.key; // Ù…ÙØªØ§Ø­ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„ÙØ±ÙŠØ¯

  // ğŸ¤– Ø§Ù„Ø±Ø¯ Ø¹Ù„Ù‰ Ø§Ù„ØªØ­ÙŠØ©
  // ÙŠØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù„ÙŠØ³Øª Ù…Ù† Ø§Ù„Ø¨ÙˆØªØŒ ÙˆØ§Ù„Ù†Øµ Ù‡Ùˆ "Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ…"ØŒ ÙˆÙ„Ù… ÙŠØªÙ… Ø§Ù„Ø±Ø¯ Ø¹Ù„ÙŠÙ‡Ø§ Ø¨Ø¹Ø¯
  if (m.userId !== "bot_id" && m.text.trim() === "Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ…" && !m.replied) {
    // ÙÙ‚Ø· Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ø°ÙŠ Ø£Ø±Ø³Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© Ù‡Ùˆ Ù…Ù† ÙŠØ±Ø¯
    if (m.userId === userId) {
      // ØªØ£Ø®ÙŠØ± Ø¨Ø³ÙŠØ· Ù„Ø¬Ø¹Ù„ Ø§Ù„Ø±Ø¯ ÙŠØ¨Ø¯Ùˆ Ø·Ø¨ÙŠØ¹ÙŠÙ‹Ø§
      setTimeout(() => {
          sendBotMessage(`ÙˆØ¹Ù„ÙŠÙƒÙ… Ø§Ù„Ø³Ù„Ø§Ù… ÙŠØ§ ${m.user} Ù…Ù†ÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆÙˆØ± ğŸ¥³ğŸ‰ğŸ‘‹`);
      }, 500);
    }
    // ÙˆØ¶Ø¹ Ø¹Ù„Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© Ø¨Ø£Ù†Ù‡ ØªÙ… Ø§Ù„Ø±Ø¯ Ø¹Ù„ÙŠÙ‡Ø§ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø±
    update(ref(db, `messages/${messageKey}`), { replied: true });
  }

  // ğŸ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙØ§Ø¦Ø² ÙÙŠ Ù„Ø¹Ø¨Ø© Ø³Ø±Ø¹Ø© Ø§Ù„ÙƒØªØ§Ø¨Ø©
  // ÙŠØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù„Ø¹Ø¨Ø© Ù‚ÙŠØ¯ Ø§Ù„ØªÙ‚Ø¯Ù…ØŒ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù„ÙŠØ³Øª Ù…Ù† Ø§Ù„Ø¨ÙˆØªØŒ Ø§Ù„Ù†Øµ ÙŠØ·Ø§Ø¨Ù‚ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø©ØŒ ÙˆÙˆÙ‚Øª Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ø¹Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©.
  if (localGameState.inProgress && m.userId !== "bot_id" && m.text.trim() === localGameState.gameWords.join(" ") && m.timestamp > localGameState.gameStartTime) {
    // ÙÙ‚Ø· Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ø°ÙŠ Ø£Ø±Ø³Ù„ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ÙÙˆØ² Ù‡Ùˆ Ù…Ù† ÙŠØ¹Ù„Ù† Ø§Ù„Ù†ØªÙŠØ¬Ø© ÙˆÙŠÙ†Ù‡ÙŠ Ø§Ù„Ù„Ø¹Ø¨Ø©
    if (m.userId === userId) {
      const endTime = m.timestamp; // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø·Ø§Ø¨Ø¹ Ø§Ù„Ø²Ù…Ù†ÙŠ Ù„Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„ÙØ§Ø¦Ø²Ø©
      const timeDiffSeconds = (endTime - localGameState.gameStartTime) / 1000;
      const totalChars = localGameState.gameWords.join(" ").length;
      const wpm = Math.round((totalChars / 5) / (timeDiffSeconds / 60)); // Ø­Ø³Ø§Ø¨ WPM

      // Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„ÙØ§Ø¦Ø² Ø¹Ø¨Ø± Ø§Ù„Ø¨ÙˆØª
      sendBotMessage(`ğŸ† Ø§Ù„ÙØ§Ø¦Ø² Ù‡Ùˆ ${m.user} Ø¨Ø³Ø±Ø¹Ø© ${wpm} ÙƒÙ„Ù…Ø© ÙÙŠ Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø©!`);
      
      // Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø© ÙÙŠ Firebase
      set(gameRef, {
          inProgress: false,
          countdownActive: false,
          countdownInitiatorId: null,
          gameWords: [],
          gameStartTime: 0,
          lastGameId: null // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ù…Ø¹Ø±Ù Ø§Ù„Ù„Ø¹Ø¨Ø©
      });
    }
  }

  // ğŸ”½ Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ÙÙ‚Ø· ÙÙŠ Ø§Ù„Ø´Ø§Øª
  // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø§ÙˆÙŠØ©
  const msgContainer = document.createElement("div");
  msgContainer.classList.add("message");

  // Ø¥Ø¶Ø§ÙØ© Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ§Ù„Ø±Ø³Ø§Ù„Ø©
  const textDiv = document.createElement("div");
  let nameColor = "white"; // Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ: ÙƒÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¨Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø¨ÙŠØ¶
  let isAdmin = false;

  // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‡Ùˆ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ØŒ ØºÙŠÙ‘Ø± Ø§Ù„Ù„ÙˆÙ† Ø¥Ù„Ù‰ Ø°Ù‡Ø¨ÙŠ
  if (m.user === ADMIN_NAME) {
    nameColor = "gold";
    isAdmin = true;
  }

  // ğŸ¤– Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù…Ù† Ø§Ù„Ø¨ÙˆØªØŒ Ø§Ø³ØªØ®Ø¯Ù… Ù„ÙˆÙ†Ù‡ Ø§Ù„Ù…Ø­Ø¯Ø¯
  if (m.user === BOT_NAME) {
    nameColor = BOT_COLOR;
  }

  // Ø£Ø¶Ù Ø§Ù„ØªØ§Ø¬ Ø¨Ø¬Ø§Ù†Ø¨ Ø§Ø³Ù… Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ ÙÙ‚Ø· ğŸ‘‘
  textDiv.innerHTML = `
    <strong class="username" style="color:${nameColor}">
      ${m.user}${isAdmin ? " ğŸ‘‘" : ""}:
    </strong> ${m.text}
  `;

  msgContainer.appendChild(textDiv);

  // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠØŒ Ø£Ø¶Ù ÙØ¦Ø© Ø®Ø§ØµØ© Ù„Ù…Ø­Ø§Ø°Ø§ØªÙ‡Ø§ ÙŠÙ…ÙŠÙ†Ù‹Ø§
  if (m.user === username) {
    msgContainer.classList.add("my-message");
  }

  // ğŸ¤– Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù…Ù† Ø§Ù„Ø¨ÙˆØªØŒ Ø£Ø¶Ù ÙØ¦Ø© Ø®Ø§ØµØ©
  if (m.user === BOT_NAME) {
    msgContainer.classList.add("bot-message");
  }

  // ğŸ”¹ Ø¥Ø¶Ø§ÙØ© ØµÙˆØ±Ø© Ø±Ù…Ø²ÙŠØ© Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ§Ø­Ø¯ Ù…Ø­Ø¯Ø¯ (Ù…Ø«Ù„Ø§Ù‹ Ø§Ù„Ù…Ø¯ÙŠØ±)
  if (m.user === ADMIN_NAME) { // â† ØºÙŠÙ‘Ø± Ø§Ù„Ø§Ø³Ù… ÙƒÙ…Ø§ ØªØ±ÙŠØ¯
    const avatar = document.createElement("img");
    avatar.src = "https://i.pinimg.com/1200x/21/3d/f8/213df8f9bc8e0189d0b494a9b195e308.jpg"; // Ø¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ù…Ø²ÙŠØ© Ù‡Ù†Ø§
    avatar.classList.add("avatar");
    msgContainer.appendChild(avatar);
  }

  // ğŸ¤– Ø¥Ø¶Ø§ÙØ© ØµÙˆØ±Ø© Ø±Ù…Ø²ÙŠØ© Ù„Ù„Ø¨ÙˆØª
  if (m.user === BOT_NAME) {
    const avatar = document.createElement("img");
    avatar.src = BOT_AVATAR_URL;
    avatar.classList.add("avatar");
    msgContainer.appendChild(avatar);
  }

  chatBox.appendChild(msgContainer);
  chatBox.scrollTop = chatBox.scrollHeight;
});

get(messagesRef).then(()=>{ firstLoad=false; });

// ğŸ”¹ ØªØ­Ø¯ÙŠØ« ÙÙˆØ±ÙŠ Ø¹Ù†Ø¯ Ø­Ø°Ù Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
onValue(messagesRef, snapshot => {
  if(!snapshot.exists()){
    chatBox.innerHTML = "";
  }
});

// ğŸ Listener Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© Ù…Ù† Firebase
onValue(gameRef, async (snapshot) => {
    const firebaseState = snapshot.val() || {};

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ© Ù„Ù„Ø¹Ø¨Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Firebase
    localGameState = {
        inProgress: firebaseState.inProgress || false,
        countdownActive: firebaseState.countdownActive || false,
        countdownInitiatorId: firebaseState.countdownInitiatorId || null,
        gameWords: firebaseState.gameWords || [],
        gameStartTime: firebaseState.gameStartTime || 0,
        lastGameId: firebaseState.lastGameId || null
    };

    // Ù…Ù†Ø·Ù‚ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ Ù„Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­Ø¯Ø¯ ÙÙ‚Ø·
    if (localGameState.countdownActive && localGameState.countdownInitiatorId === userId) {
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù‚Ø¯ Ø¨Ø¯Ø£ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ Ø¨Ø§Ù„ÙØ¹Ù„ Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø¬ÙˆÙ„Ø©
        if (initiatedCountdownGameId !== localGameState.lastGameId) {
            initiatedCountdownGameId = localGameState.lastGameId; // ÙˆØ¶Ø¹ Ø¹Ù„Ø§Ù…Ø© Ø¹Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„Ø¬ÙˆÙ„Ø©

            // ØªØ³Ù„Ø³Ù„ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
            await new Promise(resolve => setTimeout(resolve, 500));
            sendBotMessage("3...");
            await new Promise(resolve => setTimeout(resolve, 1000));
            sendBotMessage("2...");
            await new Promise(resolve => setTimeout(resolve, 1000));
            sendBotMessage("1...");
            await new Promise(resolve => setTimeout(resolve, 1000));

            // Ø¨Ø¹Ø¯ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠØŒ Ø£Ø±Ø³Ù„ Ø§Ù„ÙƒÙ„Ù…Ø§Øª ÙˆØ­Ø¯Ø« Ø­Ø§Ù„Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© ÙÙŠ Firebase
            sendBotMessage(` ${localGameState.gameWords.join(" ")}`);
            const newGameStartTime = Date.now();
            await set(gameRef, {
                ...localGameState, // Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø§Ù„Ø®ØµØ§Ø¦Øµ Ø§Ù„Ø£Ø®Ø±Ù‰
                countdownActive: false, // Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
                inProgress: true,      // Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ø¢Ù† Ù†Ø´Ø·Ø©
                gameStartTime: newGameStartTime
            });
        }
    } else if (!localGameState.inProgress && !localGameState.countdownActive) {
        // Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ø§Ù„Ù„Ø¹Ø¨Ø© Ù‚ÙŠØ¯ Ø§Ù„ØªÙ‚Ø¯Ù… ÙˆÙ„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ø¯ ØªÙ†Ø§Ø²Ù„ÙŠØŒ Ø£Ø¹Ø¯ ØªØ¹ÙŠÙŠÙ† Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø©
        initiatedCountdownGameId = null;
    }
});

// ğŸŒªï¸ Ø¯Ø§Ù„Ø© Ù„Ø®Ù„Ø· ØªØ±ØªÙŠØ¨ Ø¹Ù†Ø§ØµØ± Ù…ØµÙÙˆÙØ© (Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Fisher-Yates)
function shuffleArray(array) {
    let currentIndex = array.length, randomIndex;
    // Ø¨ÙŠÙ†Ù…Ø§ Ù„Ø§ ÙŠØ²Ø§Ù„ Ù‡Ù†Ø§Ùƒ Ø¹Ù†Ø§ØµØ± Ù„Ø®Ù„Ø·Ù‡Ø§
    while (currentIndex !== 0) {
        // Ø§Ø®ØªØ± Ø¹Ù†ØµØ±Ù‹Ø§ Ù…ØªØ¨Ù‚ÙŠÙ‹Ø§
        randomIndex = Math.floor(Math.random() * currentIndex);
        currentIndex--;
        // ÙˆÙ‚Ù… Ø¨ØªØ¨Ø¯ÙŠÙ„Ù‡ Ù…Ø¹ Ø§Ù„Ø¹Ù†ØµØ± Ø§Ù„Ø­Ø§Ù„ÙŠ
        [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
    }
    return array;
}

// ğŸ”¹ Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙˆÙ…Ø¹Ø§Ù„Ø¬Ø© Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø¨ÙˆØª
async function handleMessageSend(text) {
    if(!text) return;

    // Ø£Ù…Ø± Ø­Ø°Ù Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ (Ù„Ù„Ø£Ø¯Ù…Ù† ÙÙ‚Ø·)
    if(text.startsWith("/delete") && username === ADMIN_NAME){
        remove(messagesRef);
        return;
    }

    // ğŸ¤– Ù…Ø¹Ø§Ù„Ø¬Ø© Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø¨ÙˆØª "Ø·Ø´"
    if (text.startsWith("Ø·Ø´")) {
        const currentGameStateSnapshot = await get(gameRef); // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£Ø­Ø¯Ø« Ø­Ø§Ù„Ø© Ù„Ù„Ø¹Ø¨Ø© Ù…Ù† Firebase
        const currentGameState = currentGameStateSnapshot.val() || {};

        // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¬Ø§Ø±ÙŠØ© Ø¨Ø§Ù„ÙØ¹Ù„ Ø£Ùˆ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ Ù†Ø´Ø·
        if (currentGameState.inProgress || currentGameState.countdownActive) {
            sendBotMessage("Ù„Ø¹Ø¨Ø© Ø³Ø±Ø¹Ø© Ø§Ù„ÙƒØªØ§Ø¨Ø© Ø¬Ø§Ø±ÙŠØ© Ø¨Ø§Ù„ÙØ¹Ù„. Ø§Ù†ØªØ¸Ø± Ø­ØªÙ‰ ØªÙ†ØªÙ‡ÙŠ Ø§Ù„Ø¬ÙˆÙ„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©.");
            // Ù„Ø§ Ù†Ø±Ø³Ù„ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‡Ù†Ø§ Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø±ØŒ ÙÙ‚Ø· Ù†Ø±Ø³Ù„ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¨ÙˆØª
            return; // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø±
        }

        // Ø£Ù…Ø± "Ø·Ø´" Ù…Ø¹ Ø±Ù‚Ù… (Ù…Ø«Ø§Ù„: Ø·Ø´7) - Ù„Ø­ÙØ¸ Ø§Ù„ÙƒÙ„Ù…Ø§Øª
        if (text.match(/^Ø·Ø´(\d+)$/)) {
            const numberMatch = text.match(/^Ø·Ø´(\d+)$/);
            const count = parseInt(numberMatch[1], 10);
            if (count > 0 && count <= BOT_WORDS_LIST.length) {
                savedBotWords = BOT_WORDS_LIST.slice(0, count);
                localStorage.setItem("savedBotWords", JSON.stringify(savedBotWords));
                sendBotMessage(`âœ… ØªÙ… Ø­ÙØ¸ ${count} ÙƒÙ„Ù…Ø§Øª Ù„Ù„Ø¬ÙˆÙ„Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©.`);
            } else {
                sendBotMessage(`âš ï¸ ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ Ø¹Ø¯Ø¯ ØµØ­ÙŠØ­ Ø¨ÙŠÙ† 1 Ùˆ ${BOT_WORDS_LIST.length} Ù„Ø­ÙØ¸ Ø§Ù„ÙƒÙ„Ù…Ø§Øª.`);
            }
            return; // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
        }
        // Ø£Ù…Ø± "Ø·Ø´" ÙÙ‚Ø· - Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©
        else if (text === "Ø·Ø´") {
            if (savedBotWords.length > 0) {
                // ğŸŒªï¸ Ø®Ù„Ø· Ø§Ù„ÙƒÙ„Ù…Ø§Øª ÙˆØ§Ø®ØªÙŠØ§Ø± Ù…Ø¬Ù…ÙˆØ¹Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø© Ù„ÙƒÙ„ Ø¬ÙˆÙ„Ø©
                const shuffledWords = shuffleArray([...BOT_WORDS_LIST]); // Ø®Ù„Ø· Ù†Ø³Ø®Ø© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©
                const gameWordsForThisRound = shuffledWords.slice(0, savedBotWords.length); // Ø£Ø®Ø° Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù…Ù† Ø§Ù„ÙƒÙ„Ù…Ø§Øª

                // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© ÙÙŠ Firebase Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
                await set(gameRef, {
                    inProgress: false, // Ù„ÙŠØ³Øª Ù‚ÙŠØ¯ Ø§Ù„ØªÙ‚Ø¯Ù… Ø¨Ø¹Ø¯ØŒ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ Ù†Ø´Ø·
                    countdownActive: true,
                    countdownInitiatorId: userId, // Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø¯Ø£ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
                    gameWords: gameWordsForThisRound, // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø¬ÙˆÙ„Ø©
                    gameStartTime: 0, // Ø³ÙŠØªÙ… ØªØ¹ÙŠÙŠÙ†Ù‡ Ø¨Ø¹Ø¯ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
                    lastGameId: new Date().getTime() // Ù…Ø¹Ø±Ù ÙØ±ÙŠØ¯ Ù„Ø¬ÙˆÙ„Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© Ù‡Ø°Ù‡
                });
            } else {
                sendBotMessage("âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ ÙƒÙ„Ù…Ø§Øª Ù…Ø­ÙÙˆØ¸Ø©. Ø§Ø³ØªØ®Ø¯Ù… `Ø·Ø´` Ù…Ø¹ Ø±Ù‚Ù… Ø£ÙˆÙ„Ø§Ù‹ (Ù…Ø«Ø§Ù„: Ø·Ø´5).");
            }
            return; // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
        }
    }

    // ğŸ”„ Ø£Ù…Ø± "ÙŠÙ„Ø§" Ù„Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¬ÙˆÙ„Ø©
    if (text.trim() === "ÙŠÙ„Ø§") {
        const currentGameStateSnapshot = await get(gameRef);
        const currentGameState = currentGameStateSnapshot.val() || {};

        if (currentGameState.inProgress || currentGameState.countdownActive) {
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ø§Ù„Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© ÙÙŠ Firebase
            await set(gameRef, {
                inProgress: false, countdownActive: false, countdownInitiatorId: null,
                gameWords: [], gameStartTime: 0, lastGameId: null
            });
            sendBotMessage("ğŸ”„ ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¬ÙˆÙ„Ø©. ÙŠÙ…ÙƒÙ†ÙƒÙ… Ø§Ù„Ø¨Ø¯Ø¡ Ù…Ù† Ø¬Ø¯ÙŠØ¯ Ø¨Ø§Ù„Ø£Ù…Ø± 'Ø·Ø´'.");
        }
        // Ù„Ø§ Ù†ÙˆÙ‚Ù Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ù‡Ù†Ø§ØŒ Ù„Ù„Ø³Ù…Ø§Ø­ Ø¨Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© "ÙŠÙ„Ø§" ÙƒØ±Ø³Ø§Ù„Ø© Ø¹Ø§Ø¯ÙŠØ© Ø£Ø¯Ù†Ø§Ù‡
    }

    // Ø¥Ø±Ø³Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¹Ø§Ø¯ÙŠØ© (Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø¨ÙˆØª Ø§Ù„ØªÙŠ Ù„Ù… ÙŠØªÙ… Ø¥ÙŠÙ‚Ø§ÙÙ‡Ø§)
    // Ù‡Ø°Ø§ ÙŠØ¶Ù…Ù† Ø£Ù† userId ÙŠÙØ±Ø³Ù„ Ø¯Ø§Ø¦Ù…Ù‹Ø§
    push(messagesRef, {
        user: username,
        userId: userId, // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø±Ø³Ø§Ù„ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¯Ø§Ø¦Ù…Ù‹Ø§
        color: userColor,
        text,
        time: new Date().toLocaleTimeString(),
        timestamp: Date.now()
    });
}

// ğŸ”¹ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø¨Ø³Ø±Ø¹Ø© Ù‚ØµÙˆÙ‰ (ØªÙ… ØªØ¹Ø¯ÙŠÙ„Ù‡Ø§ Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… handleMessageSend)
form.addEventListener("submit", async e => {
  e.preventDefault();
  await handleMessageSend(msgInput.value.trim());
  msgInput.value = "";
  msgInput.focus(); // Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
  remove(ref(db,"typing/"+userId));
  if(audioEnabled) playBeep({freq:900, volume:0.7, duration:0.045});
});

// Ø¥Ø±Ø³Ø§Ù„ ÙÙˆØ±ÙŠ Ø¹Ù†Ø¯ Ø¶ØºØ· Enter (Ø¨Ø¯ÙˆÙ† Shift)
msgInput.addEventListener("keydown", async e => {
  if (e.key === "Enter" && !e.shiftKey) {
    e.preventDefault();
    await handleMessageSend(msgInput.value.trim());
    msgInput.value = "";
    msgInput.focus();
    remove(ref(db,"typing/"+userId));
    if(audioEnabled) playBeep({freq:900, volume:0.7, duration:0.045});
  }
});

// ğŸ”¹ Ø§Ù„ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø­ÙŠØ© Ù…Ø¹ Ù†Ù‚Ø§Ø· Ù…ØªØ­Ø±ÙƒØ©
let typingTimeout;
msgInput.addEventListener("input", ()=>{
  set(ref(db,"typing/"+userId),{name:username, ts:Date.now()});
  clearTimeout(typingTimeout);
  typingTimeout = setTimeout(()=>remove(ref(db,"typing/"+userId)),2500);
});

onValue(typingRef,snapshot=>{
  const typingUsers = snapshot.val() || {};
  currentTyping = {};
  const now = Date.now();
  Object.entries(typingUsers).forEach(([id,u])=>{
    if(u.name !== username && now - (u.ts||0) < 2500){
      currentTyping[id] = true;
    }
  });
  renderUsers(currentUsers, currentTyping);

  // Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø£Ø³ÙÙ„ Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©
  const names = Object.entries(typingUsers)
    .filter(([id,u])=>u.name!==username && now-(u.ts||0)<2500)
    .map(([id,u])=>u.name);
  typingBox.textContent = names.length ? `${names.join(" Ùˆ ")} ${names.length>1?"ÙŠÙƒØªØ¨ÙˆÙ† Ø§Ù„Ø¢Ù†...":"ÙŠÙƒØªØ¨ Ø§Ù„Ø¢Ù†..."}` : "";
});

} // Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø¯Ø§Ù„Ø© main
main(); // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
</script>

<style>
body {
  font-family: "Cairo", sans-serif;
  background: url("https://images.pexels.com/photos/33971618/pexels-photo-33971618.jpeg") no-repeat center center fixed;
  background-size: cover;
  color: #eee;
  margin: 0;
  padding: 0;
  text-align: center;
  display: flex;
  flex-direction: column;
  align-items: center;
  height: 100dvh;
}

/* ğŸ”¹ Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø´Ø§Øª */
.chat-container {
  width: 95%;
  max-width: 900px;
  margin-top: 20px;
}

/* ğŸ”¹ Ø¹Ù†ÙˆØ§Ù† */
h2 { 
  color: #f2f2f2;
  margin: 0 0 10px 0;
  font-size: 1.3em;
  text-shadow: 0 2px 4px rgba(0,0,0,0.3);
  position: relative;
  padding-bottom: 8px;
}

h2::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 25%;
  width: 50%;
  height: 2px;
  background: linear-gradient(to right, transparent, #7c68ee00, transparent);
  border-radius: 2px;
}

/* ğŸ”¹ ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø´Ø§Øª */
#chat {
  width: 100%;
  height: 400px;
  overflow-y: auto;
  padding: 10px;
  background: #222a5900;;
  border-radius: 10px;
  box-sizing: border-box;
  scrollbar-width: thin;
  scrollbar-color: #333 #111;
}

#chat::-webkit-scrollbar { width: 6px; }
#chat::-webkit-scrollbar-thumb {
  background-color: #333;
  border-radius: 3px;
}

/* ğŸ”¹ Ø§Ù„ÙÙ‚Ø§Ø¹Ø§Øª */
.message {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  direction: rtl;
  background-color: #090c1d69;
  border-radius: 10px;
  padding: 5px 10px;
  margin: 3px 0;
  gap: 6px;
  color: #f1f1f1;
  font-size: 0.95em;
  line-height: 1.3;
  max-width: 70%;
  word-break: break-word;
  animation: fadeIn 0.25s ease-out;
  box-shadow: 0 0 6px rgba(0,0,0,0.3);
}

/* ğŸ¤– Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¨ÙˆØª */
.message.bot-message {
  background-color: #5c1118a8; /* Ø®Ù„ÙÙŠØ© Ù…Ø®ØªÙ„ÙØ© Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¨ÙˆØª */
  border-left: 3px solid var(--bot-color, #ff4757);
  direction: ltr; /* Ù„Ø¶Ù…Ø§Ù† Ø¸Ù‡ÙˆØ± Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© ÙŠØ³Ø§Ø±Ù‹Ø§ Ø¥Ø°Ø§ Ø£Ø¶ÙŠÙØª */
  justify-content: flex-start;
}

/* ğŸ”¹ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… */
.message strong {
  display: inline;
  color: #8ef2a2;
  font-weight: bold;
  font-size: 0.9em;
  margin-left: 3px;
}

/* ğŸ”¹ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… */
.message.my-message {
  margin-left: auto;
  background-color: #667e174d;
  text-align: right;
  flex-direction: row-reverse;
}

/* ğŸ”¹ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ© */
.avatar {
  width: 26px;
  height: 26px;
  border-radius: 50%;
  border: 1.5px solid #3cdf28;
  flex-shrink: 0;
}

/* ğŸ”¹ Ø´Ø±ÙŠØ· Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ */
form {
  width: 100%;
  display: flex;
  margin-top: 8px;
  padding: 6px;
  background: rgba(27, 30, 48, 0.8);
  border-radius: 8px;
}

input {
  flex: 1;
  padding: 8px;
  border-radius: 6px;
  border: none;
  font-size: 0.95em;
  background-color: #11143100;
  color: #f9f9f9;
  outline: none;
}

button {
  padding: 8px 16px;
  border: none;
  border-radius: 6px;
  background: #7c68ee00;
  color: #ffee04;
  font-weight: bold;
  cursor: pointer;
  transition: 0.2s;
}

button:hover {
  background: #6956d600;
}

/* ğŸ”¹ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† */
#users {
  list-style: none;
  padding: 0;
  margin: 10px 0 5px 0;
  width: 95%;
  max-width: 900px;
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  justify-content: center;
}

#users li {
  background: #47474721;
  padding: 6px 12px;
  border-radius: 15px;
  font-size: 0.9em;
  transition: 0.15s;
}

/* ğŸ”¹ ØµÙˆØ±Ø© Ø§Ù„Ø£ÙØ§ØªØ§Ø± ÙÙŠ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªØµÙ„ÙŠÙ† */
.user-list-avatar {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  margin-left: 5px; /* Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„ØµÙˆØ±Ø© ÙˆØ§Ù„Ø§Ø³Ù… */
}

#users li:hover {
  transform: translateY(-2px);
  background: #222;
}

/* ğŸ”¹ ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¸Ù‡ÙˆØ± */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* ğŸš« Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø­Ø¸Ø± */
.ban-message { text-align: center; padding-top: 20vh; color: #ff5555; }
.ban-message h1 { font-size: 2.5em; }

/* ğŸ”¹ Ù„Ù„Ù‡Ø§ØªÙ */
@media screen and (max-width: 768px) {
  #chat {
    height: 250px;
    padding: 6px;
  }

  .message {
    font-size: 0.85em;
    padding: 4px 6px;
    border-radius: 8px;
    max-width: 80%;
  }

  .avatar {
    width: 22px;
    height: 22px;
  }

  input {
    font-size: 0.85em;
    padding: 6px;
  }

  button {
    padding: 7px 12px;
    font-size: 0.85em;
  }
}

/* ğŸš« Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ù„Ù„Ù…Ø´Ø±Ù */
.admin-controls {
  margin-right: auto; /* ÙŠØ¯ÙØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø¥Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø± ÙÙŠ LTRØŒ ÙˆØ¥Ù„Ù‰ Ø§Ù„ÙŠÙ…ÙŠÙ† ÙÙŠ RTL */
  display: flex;
  gap: 5px;
}
.admin-controls button {
  padding: 2px 8px;
  font-size: 0.75em;
  border-radius: 4px;
  cursor: pointer;
  border: none;
  color: white;
}
.kick-btn { background-color: #e67e22; }
.ban-btn { background-color: #c0392b; }
.kick-btn:hover { background-color: #d35400; }
.ban-btn:hover { background-color: #a52a1d; }

/* ğŸš« Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø¸Ø± */
#ban-management { display: none; /* ØªØ¸Ù‡Ø± ÙÙ‚Ø· Ù„Ù„Ù…Ø´Ø±Ù */ }
#ban-management.visible { display: block; margin-top: 20px; padding: 15px; background: #1a1a1a; border-radius: 8px; }
#banned-ips-list li { display: flex; justify-content: space-between; align-items: center; padding: 5px; border-bottom: 1px solid #333; }
.unban-btn { background-color: #27ae60; padding: 3px 8px; font-size: 0.8em; }

#users li {
    display: flex; /* Ù„ØªÙ…ÙƒÙŠÙ† Ù…Ø­Ø§Ø°Ø§Ø© Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
    align-items: center;
}
</style>





</head>
<body>
<h5 style="margin-top:20px; margin-bottom:10px;">Ø§Ù„Ù…ØªØµÙ„ÙˆÙ† Ø§Ù„Ø¢Ù†:</h5>
<ul id="users"></ul>
<!-- ØªÙ… ÙˆØ¶Ø¹ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø´Ø§Øª Ø¯Ø§Ø®Ù„ Ø­Ø§ÙˆÙŠØ© Ø¬Ø¯ÙŠØ¯Ø© Ù„ØªÙ†Ø¸ÙŠÙ…Ù‡Ø§ -->
<div class="chat-container">
  <h2>ğŸ’¬chat</h2>
  <div id="chat"></div>
  <div id="typing"></div>
  <form id="chatForm">
    <input id="msg" placeholder=" " autocomplete="off" />
    <button>Ø¥Ø±Ø³Ø§Ù„</button>
  </form>

  <!-- ğŸš« Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø¸Ø± (Ù„Ù„Ù…Ø´Ø±Ù ÙÙ‚Ø·) -->
  <div id="ban-management">
      <h3>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø¸Ø±</h3>
      <ul id="banned-ips-list"></ul>
  </div>

</div>
</body>
</html>
