<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>💬 دردشة مؤقتة</title>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js";
import { getDatabase, ref, push, set, remove, onValue, onChildAdded, onChildRemoved, onDisconnect, get, update } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-database.js";

// 🔹 كل سكريبتك الأصلي كما هو
// لا يتم لمس أي شيء هنا
// (انسخ كامل السكريبت الأصلي الذي وضعته مسبقاً)
</script>

<style>
body { 
  font-family: "Cairo", sans-serif; 
  background:#0e0e0e; 
  color:#eee; 
  margin:0; 
  padding:0; 
  display:flex; 
  flex-direction:column; 
  align-items:center; 
  height:100vh; 
}

/* عنوان الدردشة */
h2 { 
  color:#ffd166;
  margin:15px 0;
  font-size:1.3em;
}

/* صندوق الدردشة */
#chat { 
  flex:1;
  width:70%;
  max-width:800px;
  overflow-y:auto;
  border:1px solid #333;
  padding:10px;
  background:#1b1b1b;
  border-radius:10px;
  text-align:left;
  box-sizing:border-box; 
  display:flex; 
  flex-direction:column; 
  gap:4px;
}

/* فقاعات الرسائل */
.message { 
  margin:2px 0; 
  line-height:1.4; 
  word-wrap:break-word; 
}
.bubble { 
  padding:8px 12px; 
  border-radius:18px; 
  max-width:80%; 
  display:inline-block; 
}
.self { 
  align-self:flex-end; 
  border-top-right-radius:0;
}
.other { 
  align-self:flex-start; 
  border-top-left-radius:0; 
  border:1px solid #555;
}
.typing-message { 
  font-style:italic; 
}

/* حقل الكتابة أسفل */
form{ 
  width:70%;
  max-width:800px;
  display:flex;
  gap:5px;
  margin:0 auto;
  position:fixed; 
  bottom:0; 
  left:50%; 
  transform:translateX(-50%); 
  background:#0e0e0e; 
  padding:10px; 
  border-radius:8px; 
  box-sizing:border-box;
}
input{ 
  flex:1;
  padding:10px;
  border-radius:6px;
  border:none;
  outline:none;
  background:#222;
  color:#eee;
  font-size:16px;
  spellcheck:false;
  autocorrect:off;
  autocapitalize:off;
  caret-color:#06d6a0;
}
button{ 
  padding:10px 15px;
  border:none;
  border-radius:6px;
  background:#06d6a0;
  color:#000;
  font-weight:bold;
  cursor:pointer;
}

/* قائمة المستخدمين على اليسار */
#users { 
  list-style:none; 
  padding:0; 
  margin:10px 0; 
  width:25%;
  max-width:300px; 
  position:fixed;
  left:10px;
  top:70px;
  overflow-y:auto;
  max-height:70vh;
}
#users li{
  background:#222;
  margin:5px 0;
  padding:8px;
  border-radius:6px;
  text-align:right;
  font-weight:600;
  border-right:6px solid #666;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

/* الرسائل المتحركة عند الكتابة */
.dots{display:inline-block; font-family: monospace; color:#ffd166; animation:blinkDots 1s linear infinite;}
@keyframes blinkDots{0%{opacity:0.2;}25%{opacity:0.5;}50%{opacity:1;}75%{opacity:0.5;}100%{opacity:0.2;}}

/* النصوص أسفل الدردشة */
#typing{font-size:14px;color:#ffd166;margin:5px;min-height:18px;}

/* استجابة للشاشات الصغيرة */
@media screen and (max-width:600px){
  #chat { max-height:60vh; width:95%; }
  form { width:95%; }
  #users { display:none; }
}
</style>

<body>
<h2>💬 دردشة مؤقتة</h2>

<div id="chat"></div>
<div id="typing"></div>

<form id="chatForm">
  <input id="msg" placeholder="اكتب رسالتك..." autocomplete="off" />
  <button>إرسال</button>
</form>

<h3>المتصلون الآن:</h3>
<ul id="users"></ul>
</body>
</html>
